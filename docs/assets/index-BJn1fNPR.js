(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();typeof requestIdleCallback>"u"&&(window.requestIdleCallback=function(e,t){const n=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)});typeof cancelIdleCallback>"u"&&(window.cancelIdleCallback=function(e){clearTimeout(e)});const v=document.getElementById("spiralCanvas"),p=v.getContext("2d");let Y=5,T=5e3,u=2,M=[],A=!0,B=!0,h=!0,_=.1,we=0,C=!0,k=.1,z=10,c=!1,E=!1,de=!0,g=!1,w=!1,y=!1,R=100,P=.1,a=1,r=500,ye=1,J=null,F=100;const ne=200,Xe=1,$e=10,Ve=.25,le=[];let W=null;function me(){const e=document.getElementById("fullscreenToast");e.classList.add("show"),W&&clearTimeout(W),W=setTimeout(()=>{e.classList.remove("show")},3e3)}async function ve(){if(window.__TAURI__)try{await window.__TAURI__.window.getCurrentWindow().setFullscreen(!0)}catch(e){console.error("Failed to enter fullscreen:",e)}else{const e=document.documentElement;try{e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.msRequestFullscreen&&await e.msRequestFullscreen()}catch(t){console.error("Failed to enter fullscreen:",t)}}}async function ae(){if(window.__TAURI__)try{await window.__TAURI__.window.getCurrentWindow().setFullscreen(!1)}catch(e){console.error("Failed to exit fullscreen:",e)}else try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(e){console.error("Failed to exit fullscreen:",e)}}async function oe(){console.log("Showing interface in fullscreen mode");const e=document.getElementById("sidebar"),t=document.getElementById("sidebarToggle"),n=document.getElementById("fullscreenToggle");e.style.display="flex",t.style.display="flex",n.style.display="flex";const i=document.getElementById("fullscreenToast");i.textContent="Interface restored - Use macOS fullscreen controls to exit, or ESC to hide interface",i.classList.add("show"),W&&clearTimeout(W),W=setTimeout(()=>{i.classList.remove("show"),i.textContent="Press ESC to exit fullscreen"},4e3)}function se(){console.log("Hiding interface in fullscreen mode");const e=document.getElementById("sidebar"),t=document.getElementById("sidebarToggle"),n=document.getElementById("fullscreenToggle");e.style.display="none",t.style.display="none",n.style.display="none";const i=document.getElementById("fullscreenToast");i.textContent="Interface hidden - Press ESC to show interface",i.classList.add("show"),W&&clearTimeout(W),W=setTimeout(()=>{i.classList.remove("show")},3e3)}async function Se(){if(window.__TAURI__)c?E?(console.log("Toggling interface visibility instead of exiting fullscreen (was fullscreen before)"),g?(se(),g=!1):(oe(),g=!0)):(console.log("Exiting fullscreen (was not fullscreen before)"),c=!1,E=!1,de=!0,g=!1,await ae(),H(),s("isFullscreen",c),setTimeout(()=>{K()},500)):(console.log("Entering fullscreen (was fullscreen before:",c,")"),E=c,c=!0,de=!0,g=!1,await ve(),H(),s("isFullscreen",c));else if(!c)E=c,await ve();else if(E){me();return}else await ae(),E=!1,g=!1,setTimeout(()=>{K()},500)}function H(){const e=c;window.__TAURI__||(c=!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement));const t=document.getElementById("sidebar"),n=document.getElementById("sidebarToggle"),i=document.getElementById("fullscreenToggle");if(c){if(t.style.display="none",n.style.display="none",i.style.display="none",!e){const o=document.getElementById("fullscreenToast");E?o.textContent="Fullscreen mode - Press ESC to toggle menu":o.textContent="Fullscreen mode - Press ESC to exit fullscreen",me()}}else{t.style.display="flex",n.style.display="flex",i.style.display="flex",i.textContent="⛶",i.title="Toggle Fullscreen";const o=document.getElementById("fullscreenToast");o.classList.remove("show"),o.textContent="Press ESC to exit fullscreen"}}let L;const Ge="SpiralPrefs",Je=1,q="preferences";function Qe(){const e=indexedDB.open(Ge,Je);e.onerror=()=>console.warn("IndexedDB not available"),e.onsuccess=t=>{L=t.target.result,Ze(),window.__TAURI__&&setTimeout(()=>{ge()},200)},e.onupgradeneeded=t=>{L=t.target.result,L.createObjectStore(q,{keyPath:"id"})}}function s(e,t){if(!L)return;L.transaction([q],"readwrite").objectStore(q).put({id:e,value:t})}async function K(){if(window.__TAURI__)try{const e=window.__TAURI__.window.getCurrentWindow(),t=await e.innerSize(),n=await e.innerPosition(),i=await e.isMaximized();c?console.log("Skipping window size save (in fullscreen mode)"):(s("windowWidth",t.width),s("windowHeight",t.height),s("windowX",n.x),s("windowY",n.y),s("windowMaximized",i),console.log("Window state saved:",{width:t.width,height:t.height,fullscreen:c})),s("isFullscreen",c)}catch(e){console.error("Failed to save window state:",e)}}async function ge(){if(!window.__TAURI__||!L){console.log("Skipping window state load - Tauri not available or DB not ready");return}console.log("Loading window state...");try{const e=window.__TAURI__.window.getCurrentWindow();await new Promise(d=>setTimeout(d,100));const n=L.transaction([q],"readonly").objectStore(q),i=d=>new Promise(I=>{const m=n.get(d);m.onsuccess=()=>{var x;return I((x=m.result)==null?void 0:x.value)},m.onerror=()=>I(null)}),[o,l,f,U,b,S]=await Promise.all([i("windowWidth"),i("windowHeight"),i("windowX"),i("windowY"),i("windowMaximized"),i("isFullscreen")]);if(console.log("Loaded window state:",{width:o,height:l,x:f,y:U,maximized:b,fullscreen:S}),o&&l&&o>200&&l>200)if(o<=3840&&l<=2160)try{await e.setSize(new window.__TAURI__.window.LogicalSize(o,l)),console.log("✅ Window size restored:",o,"x",l)}catch(m){console.error("❌ Failed to restore window size:",m)}else console.log("❌ Saved window size too large, skipping restore:",o,"x",l),s("windowWidth",null),s("windowHeight",null);else console.log("❌ No valid window size to restore");if(f!==null&&U!==null&&f>=-1e3&&U>=-1e3)try{await e.setPosition(new window.__TAURI__.window.LogicalPosition(f,U)),console.log("✅ Window position restored:",f,",",U)}catch(d){console.error("❌ Failed to restore window position:",d)}else console.log("❌ No valid window position to restore");if(b)try{await e.maximize(),console.log("✅ Window maximized state restored")}catch(d){console.error("❌ Failed to restore maximized state:",d)}S&&setTimeout(async()=>{try{console.log("⚠️  Restoring fullscreen state..."),!1||(console.log("⏭️  Skipping fullscreen restoration (disabled for development)"),c=!1,E=!1,g=!1,s("isFullscreen",!1))}catch(d){console.error("❌ Failed to restore fullscreen state:",d),c=!1,E=!1,g=!1,s("isFullscreen",!1)}},300)}catch(e){console.error("❌ Failed to load window state:",e)}}function Ze(){if(!L)return;const t=L.transaction([q],"readonly").objectStore(q);t.get("sidebarCollapsed").onsuccess=n=>{if(n.target.result){const i=document.getElementById("sidebar"),o=document.getElementById("sidebarToggle");n.target.result.value?(i.classList.add("collapsed"),o.textContent="☰",o.setAttribute("aria-expanded","false")):(o.textContent="✕",o.setAttribute("aria-expanded","true"))}else{const i=document.getElementById("sidebarToggle");i.textContent="✕",i.setAttribute("aria-expanded","true")}},t.get("spiralCoeff").onsuccess=n=>{n.target.result&&(u=n.target.result.value,document.getElementById("spiralSlider").value=u,document.getElementById("spiralNumber").value=u,N())},t.get("maxN").onsuccess=n=>{n.target.result&&(T=n.target.result.value,document.getElementById("maxNSlider").value=T,document.getElementById("maxNNumber").value=T,N())},t.get("clusterCount").onsuccess=n=>{n.target.result&&(F=n.target.result.value,document.getElementById("clusterCountSlider").value=F,document.getElementById("clusterCountNumber").value=F,fe())},t.get("showPrimes").onsuccess=n=>{if(n.target.result!==void 0){A=n.target.result.value;const i=document.getElementById("primeToggle");i.classList.toggle("active",A),i.setAttribute("aria-checked",A.toString()),i.textContent=A?"Defocus Prime Numbers":"Focus Prime Numbers"}},t.get("showClusters").onsuccess=n=>{if(n.target.result!==void 0){B=n.target.result.value;const i=document.getElementById("clusterToggle");i.classList.toggle("active",B),i.setAttribute("aria-checked",B.toString()),i.textContent=B?"Stop Animation":"Start Animation"}},t.get("showRotation").onsuccess=n=>{if(n.target.result!==void 0){h=n.target.result.value;const i=document.getElementById("rotationToggle");i.classList.toggle("active",h),i.setAttribute("aria-checked",h.toString()),i.textContent=h?"Stop Rotation":"Start Rotation"}},t.get("rotationSpeed").onsuccess=n=>{n.target.result&&(_=n.target.result.value,document.getElementById("rotationSpeedSlider").value=_,document.getElementById("rotationSpeedNumber").value=_)},t.get("useSquares").onsuccess=n=>{if(n.target.result!==void 0){C=n.target.result.value;const i=document.getElementById("shapeToggle");i.classList.toggle("active",C),i.setAttribute("aria-checked",C.toString()),i.textContent=C?"Use Circles":"Use Squares"}},t.get("instantRender").onsuccess=n=>{if(n.target.result!==void 0){w=n.target.result.value;const i=document.getElementById("instantRenderToggle");i.classList.toggle("active",w),i.setAttribute("aria-checked",w.toString()),i.textContent=w?"Disable Instant Render":"Enable Instant Render"}},t.get("dotSize").onsuccess=n=>{n.target.result&&(k=n.target.result.value,document.getElementById("dotSizeSlider").value=k,document.getElementById("dotSizeNumber").value=k)},t.get("primeSize").onsuccess=n=>{n.target.result&&(z=n.target.result.value,document.getElementById("primeSizeSlider").value=z,document.getElementById("primeSizeNumber").value=z)},t.get("scale").onsuccess=n=>{n.target.result&&(Y=n.target.result.value,N())},t.get("animateSpiralCoeff").onsuccess=n=>{if(n.target.result!==void 0){y=n.target.result.value;const i=document.getElementById("spiralAnimationToggle");i.classList.toggle("active",y),i.setAttribute("aria-checked",y.toString()),i.textContent=y?"Stop Spiral Animation":"Animate Spiral Coefficient";const o=document.getElementById("spiralAnimationControls");o.style.display=y?"block":"none",y&&re()}},t.get("spiralAnimationSpeed").onsuccess=n=>{n.target.result&&(R=n.target.result.value,document.getElementById("spiralAnimationSpeedSlider").value=R,document.getElementById("spiralAnimationSpeedNumber").value=R)},t.get("spiralAnimationIncrement").onsuccess=n=>{n.target.result&&(P=n.target.result.value,document.getElementById("spiralAnimationIncrementSlider").value=P,document.getElementById("spiralAnimationIncrementNumber").value=P)},t.get("spiralAnimationMin").onsuccess=n=>{n.target.result&&(a=n.target.result.value,document.getElementById("spiralAnimationMinSlider").value=a,document.getElementById("spiralAnimationMinNumber").value=a)},t.get("spiralAnimationMax").onsuccess=n=>{n.target.result&&(r=n.target.result.value,document.getElementById("spiralAnimationMaxSlider").value=r,document.getElementById("spiralAnimationMaxNumber").value=r)}}const D=new Map;function he(e){if(D.has(e))return D.get(e);if(e<2)return D.set(e,!1),!1;if(e===2)return D.set(e,!0),!0;if(e%2===0)return D.set(e,!1),!1;for(let t=3;t*t<=e;t+=2)if(e%t===0)return D.set(e,!1),!1;return D.set(e,!0),!0}function Ie(){v.width=window.innerWidth,v.height=window.innerHeight,N(),fe()}function N(){const e=v.width,t=v.height,n=e/2,i=t/2;M=[],window.currentComputationId&&(cancelIdleCallback(window.currentComputationId),window.currentComputationId=null);const o=Math.min(T,2e6),f=Math.sqrt(e*e+t*t)/2;if(w){for(let b=1;b<=o;b++){const S=Math.sqrt(b)*Y,d=u*Math.PI*Math.sqrt(b),I=n+S*Math.cos(d),m=i+S*Math.sin(d),x=h?f:0;I<-x||I>e+x||m<-x||m>t+x||M.push({x:I,y:m,n:b,isPrime:he(b)})}T>o&&console.warn(`Capped point calculation at ${o} for performance`)}else{let d=function(){const I=Math.min(S+1e3,o);for(let m=S;m<=I;m++){const x=Math.sqrt(m)*Y,ee=u*Math.PI*Math.sqrt(m),j=n+x*Math.cos(ee),ue=i+x*Math.sin(ee),te=h?f:0;j<-te||j>e+te||ue<-te||ue>t+te||M.push({x:j,y:ue,n:m,isPrime:he(m)})}S=I+1,S<=o?window.currentComputationId=requestIdleCallback(d,{timeout:50}):(window.currentComputationId=null,T>o&&console.warn(`Capped point calculation at ${o} for performance`))};var U=d;let S=1;window.currentComputationId=requestIdleCallback(d,{timeout:50})}}function fe(){le.length=0;const e=v.width,t=v.height,n=Math.min(F,1e3);for(let i=0;i<n;i++){const o=Math.random()*e,l=Math.random()*t;le.push({x:o,y:l,targetX:Math.random()*e,targetY:Math.random()*t,speed:2+Math.random()*1})}F>n&&console.warn(`Capped cluster count at ${n} for performance`)}function et(){const e=v.width,t=v.height;le.forEach(n=>{const i=n.targetX-n.x,o=n.targetY-n.y,l=Math.hypot(i,o);l<n.speed?(n.targetX=Math.random()*e,n.targetY=Math.random()*t):(n.x+=i/l*n.speed,n.y+=o/l*n.speed)})}function be(){B&&et(),h&&(we+=_*.01),p.fillStyle=`rgba(0,0,0,${Ve})`,p.fillRect(0,0,v.width,v.height),p.save(),h&&(p.translate(v.width/2,v.height/2),p.rotate(we),p.translate(-v.width/2,-v.height/2));let e;w||M.length<=1e4?e=M.length:M.length<=5e4?e=Math.min(M.length,2e3):e=Math.min(M.length,5e3);const t=[],n=[];for(let i=0;i<e;i++){const o=M[i%M.length];let l=0;if(B)for(const d of le){const I=o.x-d.x,m=o.y-d.y;if(Math.abs(I)<ne&&Math.abs(m)<ne){const x=1-Math.abs(I)/ne,ee=1-Math.abs(m)/ne,j=Math.min(x,ee);l=Math.max(l,j)}}let f=k;A&&o.isPrime&&(f*=z);const U=f+l*Xe,b=-l*$e,S={...o,size:U,offsetY:b};A&&o.isPrime?t.push(S):n.push(S)}n.length>0&&(p.fillStyle="#009900",n.forEach(i=>{C?p.fillRect(i.x-i.size/2,i.y+i.offsetY-i.size/2,i.size,i.size):(p.beginPath(),p.arc(i.x,i.y+i.offsetY,i.size/2,0,2*Math.PI),p.fill())})),t.length>0&&(p.fillStyle="#00ff00",t.forEach(i=>{C?p.fillRect(i.x-i.size/2,i.y+i.offsetY-i.size/2,i.size,i.size):(p.beginPath(),p.arc(i.x,i.y+i.offsetY,i.size/2,0,2*Math.PI),p.fill())})),p.restore(),requestAnimationFrame(be)}const tt=ce(e=>s("scale",e),200);window.addEventListener("wheel",e=>{e.preventDefault(),Y=_e(Y*(e.deltaY>0?1.05:.95),2,200),tt(Y),w?N():Z()},{passive:!1});const nt=document.getElementById("sidebar");nt.addEventListener("wheel",e=>{e.stopPropagation()},{passive:!0});const it=document.getElementById("fullscreenToggle");it.addEventListener("click",Se);document.addEventListener("fullscreenchange",H);document.addEventListener("webkitfullscreenchange",H);document.addEventListener("msfullscreenchange",H);v.addEventListener("click",()=>{c&&me()});const xe=document.getElementById("sidebar"),Q=document.getElementById("sidebarToggle");Q.addEventListener("click",()=>{const e=xe.classList.toggle("collapsed");Q.textContent=e?"☰":"✕",Q.setAttribute("aria-expanded",(!e).toString()),s("sidebarCollapsed",e)});const O=document.getElementById("primeToggle");O.addEventListener("click",()=>{A=!A,O.classList.toggle("active",A),O.setAttribute("aria-checked",A.toString()),O.textContent=A?"Defocus Prime Numbers":"Focus Prime Numbers",s("showPrimes",A)});const X=document.getElementById("clusterToggle");X.addEventListener("click",()=>{B=!B,X.classList.toggle("active",B),X.setAttribute("aria-checked",B.toString()),X.textContent=B?"Stop Animation":"Start Animation",s("showClusters",B)});const $=document.getElementById("rotationToggle");$.addEventListener("click",()=>{h=!h,$.classList.toggle("active",h),$.setAttribute("aria-checked",h.toString()),$.textContent=h?"Stop Rotation":"Start Rotation",s("showRotation",h),N()});const V=document.getElementById("shapeToggle");V.addEventListener("click",()=>{C=!C,V.classList.toggle("active",C),V.setAttribute("aria-checked",C.toString()),V.textContent=C?"Use Circles":"Use Squares",s("useSquares",C)});const G=document.getElementById("instantRenderToggle");G.addEventListener("click",()=>{w=!w,G.classList.toggle("active",w),G.setAttribute("aria-checked",w.toString()),G.textContent=w?"Disable Instant Render":"Enable Instant Render",s("instantRender",w)});function re(){J||(J=setInterval(()=>{u+=P*ye,(u<=a||u>=r)&&(ye*=-1),document.getElementById("spiralSlider").value=u,document.getElementById("spiralNumber").value=u,s("spiralCoeff",u),N()},R))}function pe(){J&&(clearInterval(J),J=null)}const ie=document.getElementById("spiralAnimationToggle");ie.addEventListener("click",()=>{y=!y,ie.classList.toggle("active",y),ie.setAttribute("aria-checked",y.toString()),ie.textContent=y?"Stop Spiral Animation":"Animate Spiral Coefficient";const e=document.getElementById("spiralAnimationControls");e.style.display=y?"block":"none",y?re():pe(),s("animateSpiralCoeff",y)});const Ae=document.getElementById("spiralAnimationSpeedSlider"),Be=document.getElementById("spiralAnimationSpeedNumber");Ae.addEventListener("input",e=>{R=parseInt(e.target.value),Be.value=R,s("spiralAnimationSpeed",R),y&&(pe(),re())});Be.addEventListener("input",e=>{const t=parseInt(e.target.value);t>=50&&t<=500&&!isNaN(t)&&(R=t,t>=100&&t<=500&&(Ae.value=R),s("spiralAnimationSpeed",R),y&&(pe(),re()))});const Ce=document.getElementById("spiralAnimationIncrementSlider"),Te=document.getElementById("spiralAnimationIncrementNumber");Ce.addEventListener("input",e=>{P=parseFloat(e.target.value),Te.value=P,s("spiralAnimationIncrement",P)});Te.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=.01&&t<=10&&!isNaN(t)&&(P=t,t>=.01&&t<=2&&(Ce.value=P),s("spiralAnimationIncrement",P))});const Ne=document.getElementById("spiralAnimationMinSlider"),Me=document.getElementById("spiralAnimationMinNumber");Ne.addEventListener("input",e=>{a=parseFloat(e.target.value),Me.value=a,s("spiralAnimationMin",a),a>=r&&(r=a+10,document.getElementById("spiralAnimationMaxSlider").value=r,document.getElementById("spiralAnimationMaxNumber").value=r,s("spiralAnimationMax",r))});Me.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=.1&&t<=1e3&&!isNaN(t)&&(a=t,t>=.1&&t<=100&&(Ne.value=a),s("spiralAnimationMin",a),a>=r&&(r=a+10,document.getElementById("spiralAnimationMaxSlider").value=r,document.getElementById("spiralAnimationMaxNumber").value=r,s("spiralAnimationMax",r)))});const Fe=document.getElementById("spiralAnimationMaxSlider"),Le=document.getElementById("spiralAnimationMaxNumber");Fe.addEventListener("input",e=>{r=parseFloat(e.target.value),Le.value=r,s("spiralAnimationMax",r),r<=a&&(a=Math.max(.1,r-10),document.getElementById("spiralAnimationMinSlider").value=a,document.getElementById("spiralAnimationMinNumber").value=a,s("spiralAnimationMin",a))});Le.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=10&&t<=2e3&&!isNaN(t)&&(r=t,t>=10&&t<=1e3&&(Fe.value=r),s("spiralAnimationMax",r),r<=a&&(a=Math.max(.1,r-10),document.getElementById("spiralAnimationMinSlider").value=a,document.getElementById("spiralAnimationMinNumber").value=a,s("spiralAnimationMin",a)))});function _e(e,t,n){return Math.max(t,Math.min(n,e))}function ot(){const e=document.getElementById("spiralAnimationMinNumber"),t=document.getElementById("spiralAnimationMaxNumber");a=parseFloat(e.value),r=parseFloat(t.value),u=_e(u,a,r),document.getElementById("spiralSlider").value=u,document.getElementById("spiralNumber").value=u,s("spiralCoeff",u),s("spiralAnimationMin",a),s("spiralAnimationMax",r)}function st(){const e=document.getElementById("spiralAnimationMinNumber"),t=document.getElementById("spiralAnimationMaxNumber");e.value=a=parseFloat(Ee("spiralAnimationMin",1)),t.value=r=parseFloat(Ee("spiralAnimationMax",500)),ot()}function Ee(e,t){if(!L)return t;const i=L.transaction([q],"readonly").objectStore(q);return new Promise(o=>{const l=i.get(e);l.onsuccess=()=>{var f;return o(((f=l.result)==null?void 0:f.value)||t)},l.onerror=()=>o(t)})}window.addEventListener("load",()=>{st()});function ce(e,t){let n;return function(...o){const l=()=>{clearTimeout(n),e(...o)};clearTimeout(n),n=setTimeout(l,t)}}const Z=ce(N,100),ke=ce(fe,100),ze=document.getElementById("spiralSlider"),Re=document.getElementById("spiralNumber");ze.addEventListener("input",e=>{u=parseFloat(e.target.value),Re.value=u,s("spiralCoeff",u),w?N():Z()});Re.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=0&&t<=2e3&&!isNaN(t)&&(u=t,t>=2&&t<=200&&(ze.value=u),s("spiralCoeff",u),w?N():Z())});const Pe=document.getElementById("maxNSlider"),We=document.getElementById("maxNNumber");Pe.addEventListener("input",e=>{T=parseInt(e.target.value),We.value=T,s("maxN",T),w?N():Z()});We.addEventListener("input",e=>{const t=parseInt(e.target.value);t>=1&&t<=19e5&&!isNaN(t)&&(T=t,t>=2e4&&t<=19e4&&(Pe.value=T),t>5e5&&console.warn(`Warning: Using ${t} points may impact performance`),s("maxN",T),w?N():Z())});const qe=document.getElementById("clusterCountSlider"),Ue=document.getElementById("clusterCountNumber");qe.addEventListener("input",e=>{F=parseInt(e.target.value),Ue.value=F,s("clusterCount",F),ke()});Ue.addEventListener("input",e=>{const t=parseInt(e.target.value);t>=0&&t<=2e3&&!isNaN(t)&&(F=t,t>=100&&t<=200&&(qe.value=F),t>500&&console.warn(`Warning: Using ${t} clusters may impact performance`),s("clusterCount",F),ke())});const De=document.getElementById("rotationSpeedSlider"),Ke=document.getElementById("rotationSpeedNumber");De.addEventListener("input",e=>{_=parseFloat(e.target.value),Ke.value=_,s("rotationSpeed",_)});Ke.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=.1&&t<=10&&!isNaN(t)&&(_=t,t>=.1&&t<=5&&(De.value=_),s("rotationSpeed",_))});const He=document.getElementById("dotSizeSlider"),Ye=document.getElementById("dotSizeNumber");He.addEventListener("input",e=>{k=parseFloat(e.target.value),Ye.value=k,s("dotSize",k)});Ye.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=.1&&t<=20&&!isNaN(t)&&(k=t,t>=.5&&t<=10&&(He.value=k),s("dotSize",k))});const je=document.getElementById("primeSizeSlider"),Oe=document.getElementById("primeSizeNumber");je.addEventListener("input",e=>{z=parseFloat(e.target.value),Oe.value=z,s("primeSize",z)});Oe.addEventListener("input",e=>{const t=parseFloat(e.target.value);t>=.1&&t<=10&&!isNaN(t)&&(z=t,t>=.5&&t<=5&&(je.value=z),s("primeSize",z))});document.addEventListener("keydown",e=>{e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"||(e.key==="Escape"&&(c?window.__TAURI__?E?(console.log("ESC: Toggling interface visibility in fullscreen (was fullscreen before)"),g?(se(),g=!1):(oe(),g=!0)):(console.log("ESC: Exiting fullscreen"),c=!1,E=!1,de=!0,g=!1,ae(),H(),s("isFullscreen",c),setTimeout(()=>{K()},500)):E?g?(se(),g=!1):(oe(),g=!0):(c=!1,ae(),H(),E=!1,g=!1,setTimeout(()=>{K()},500)):xe.classList.contains("collapsed")||Q.click()),(e.key==="F11"||e.key==="f"&&!e.ctrlKey&&!e.metaKey)&&(e.preventDefault(),c&&E?(console.log("F key: Toggling interface visibility in fullscreen (was fullscreen before)"),g?(se(),g=!1):(oe(),g=!0)):Se()),e.key==="s"&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),Q.click()),e.key==="p"&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),O.click()),e.key==="a"&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),X.click()),e.key==="r"&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),$.click()),e.key==="c"&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),V.click()),e.key==="i"&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),G.click()))});window.addEventListener("resize",Ie);window.addEventListener("load",()=>{document.body&&(document.body.tabIndex=-1,document.body.focus()),window.__TAURI__&&setTimeout(()=>{console.log("Attempting window state restore from window load event..."),ge()},500)});if(window.__TAURI__){const e=ce(K,500);window.addEventListener("resize",e),window.addEventListener("focus",e),window.addEventListener("blur",e),window.addEventListener("beforeunload",()=>{K()}),window.debugSaveWindowState=K,window.debugLoadWindowState=ge,console.log("Tauri window state persistence enabled"),console.log("Debug commands available: debugSaveWindowState(), debugLoadWindowState()")}Qe();Ie();requestAnimationFrame(be);
